<%= form_for(@computer, :remote => true, :class => "edit_computer_#{@computer.id}") do |f| %>
	<div class="fields">
		<div class="ip">
			<%= f.number_field :ip, :autofocus => true%>
		</div>
		<div  class="dpto">
			<%= f.select :dpto_id, @dptos.to_a.collect {|d| [d.name, d.id] }, {include_blank: true}, :class => "computer_dpto_id_#{@computer.id}"%>
		</div>
		<div class="subdpto">
			<%= select_tag :subdpto_id, {}, :disabled => true,  :class => "computer_subdpto_id_#{@computer.id}"%>
		</div>
		<div class="sort">
			<%= f.text_field :sort %>
		</div>
		<div class="name">
		<%= f.text_field :name %>
		</div>
		<div class="actions">
			<%= f.submit  "Atualizar" %>  
			<input type="button" class="cancel_btn" value="Cancelar"/>
		</div>
	</div>
	<script type="text/javascript">
	jQuery(function($) {
	// when the #region_id field changes
		$(".computer_dpto_id_<%= @computer.id %>").change(function() {
			// make a POST call and replace the content
			var dpto = $('.computer_dpto_id_<%= @computer.id %> :selected').val();
			if(dpto == "") dpto="0";
			jQuery.get('/computers/get_subdptos/' + dpto, function(data){
					$(".computer_subdpto_id_<%= @computer.id %>").replaceWith(data);
			})
			return false;
		});
		$(".cancel_btn").click(function(){
			$('#edit_computer_<%= @computer.id %>').replaceWith('<tr class="fields" id="computer_item_<%= @computer.id %>"><td class="ip"><%= @computer.ip %></td><% @dptos.each do |d| %><td><%=j d.abbr if @computer.dpto_id == d.id %></td>  <% end %><% @subdptos.each do |s| %><td><%=j s.abbr if @computer.subdpto_id == s.id %></td>  <% end %><td><%= @computer.sort %></td><td><%= @computer.name %></td><td class="actions"><%=j link_to "Edit", edit_computer_path(@computer), :remote => true %><%=j link_to "Destroy", @computer, method: :delete, data: { confirm: "Tem certeza?" }, :remote => true %></td></tr>');
		});
	})
	</script>
<% end %>